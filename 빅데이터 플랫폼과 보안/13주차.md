# Clustering
- 빅데이터를 응용함에 있어서 엄청난 양의 데이터와 처리를 요구함
- 이를 위해 데이터를 분할하고, 각각의 부분을 처리하는 방법이 필요함
- 클러스터링을 사용하여 이러한 문제를 해결할 수 있으나, 스케일링(규모의 확장)에 적합하지 않음

![alt text](이미지/image-100.png)

랙에 설치되어 있는 노드, 각 노드가 서로 통신하기 위한 네트워크 스위치, 하드디스크가 하나의 클러스터를 형성함

### Server form factors
![alt text](이미지/image-101.png)
- 각 데이터 센터에 존재하는 다수의 서버들로 가상환경을 구성하여 데이터를 처리하는 방법 -> 클라우드 컴퓨팅  
- 즉, 각 클러스터는 다수의 서버(노드)로 구성되어 있음 따라서 이 내용을 먼저 다룸

- blade server: 블레이드 서버는 다수의 서버를 하나의 케이스에 넣어 놓은 형태 즉, 파워, 네트워크, 냉각장치 등을 **공유**함 -> 따라서 각 노드들은 blade server에서 분리했을때 독립적으로 작동할 수 없음
- Rack server: 랙 서버는 각각의 서버가 독립적으로 작동함 -> 따라서 각 노드들은 stand alone으로 독립적으로 작동할 수 있음
- micro server: 서버가 소모하는 엄청난 양의 전기소모를 줄이기 위해 설계됨, arm 프로세서를 사용하여 각 서버의 성능은 떨어지지만 엄청난 전성비를 가짐 -> 최근 트렌드.
- Tower server: 타워 서버는 일반적인 PC와 비슷한 형태를 가지고 있어, 별도의 랙, 블레이드 없이 각각 독립적으로 작동함
### Rack Server vs Blade Server

| 특징 | 랙 서버 | 블레이드 서버 |
|------|---------|---------------|
| **전원 공급 장치, 팬, 케이블** | 각 서버는 자체 전원 공급 장치, 팬, 케이블을 가짐. | 팬, 전원 공급 장치, 이더넷 스위칭, 스토리지를 공유하는 인프라. 네트워킹과 스토리지가 섀시에 내장되어 있어 케이블이 필요 없음. |
| **물리적 공간** | 랙마운트를 수용하기 위해 큰 물리적 공간이 필요함. | 작은 폼 팩터로 랙마운트 서버의 절반 공간만 사용할 수 있음. |
| **배포 난이도** | 배포가 더 어려움. SMB는 랙마운트에 추가를 위해 현장 기술자가 필요할 수 있음. | 설치에 특별한 도구나 전문 지식이 필요하지 않으며, 반기술적 또는 비기술적 직원이 블레이드를 배포할 수 있음. 핫스왑 가능. |
| **시스템 공급업체** | 인수 시 시스템 공급업체 선택의 폭이 넓음. 하나의 섀시에 여러 공급업체의 다양한 구성 요소를 사용할 수 있음. -> 랙 서버는 표준화 되어있음 존재함. | 독점적인 특성으로 인해 하나의 섀시에 여러 공급업체의 구성 요소를 혼합하여 사용할 수 없음. -> 각 업체마다 규격이 다 다름.|
| **냉각** | 다양한 랙마운트 쿨러가 사용 가능. 별도의 팬이 냉각 문제를 해결함. | 많은 블레이드가 섀시의 공유 냉각으로 인해 여전히 냉각 문제를 겪음. |
- 랙서버는, 각 노드에 메모리와 파워가 존재하여 독립적으로 작동할 수 있으나, 공간을 많이 차지하고 보다 많은 전력을 소모함

### Power and Cooling

- 각 클러스터는 엄청나게 많은 전력을 소모함
- 예 > 각 서버가 140W를 소모한다면, 32대의 서버로 이루어진 하나의 렉은 4.5kW를 소모함
- 즉, 렉에 특수한 전력 공급 장치가 필요함
- 또한, 대부분의 전력이 열로 변환되므로, 엄청난 규모의 냉각장치가 필요함

### Data center cooling problems
![alt text](이미지/image-102.png)
- 각 렉서버가 밀집되어 있으므로 쿨러에서 보낸 냉기가 서버에 도달하지 못할 수 있음
- 대류가 제대로 이루어지지 않으면, 쿨러를 아무리 돌려도 효과가 없음. 심지어 더 뜨거워질 수 있음
- 각 렉서버의 크기때문에 겨우 5cm의 쿨링팬이 달려있어, 제대로된 냉각을 하기에 부족한 성능을 가짐
![alt text](이미지/image-103.png)
쿨러는 기본적으로 따듯한-뜨거운 온도를 빨아들여 차가운 온도로 바꾸어 렉에 보냄 -> 렉에 있는 서버는 뜨거운 온도를 빨아들여 차가운 온도로 바꾸어 다시 쿨러로 보냄 -> 이러한 과정을 반복함

따라서 쿨러드는 서로 등을 맞대고 있어야함
바닥에 있는 Perforated Tiles를 통해 냉기가 각 렉에 전달됨 -> 뜨거운 공기는 위로 올라가서 다시 쿨러로 보내짐

### Further scaling up

![alt text](이미지/image-104.png)

- 더 많은 렉을 추가하면, 더 많은 전력과 냉각장치가 필요함
- 그렇다면 더많은 공간과 시스템이 필요함 -> 결과: 데이터 센터가 탄생함.

위 사진에 있는 각 건물은 축구장 하나의 사이즈임.

![alt text](이미지/image-105.png)
- 데이터 센터는 전력이 차단되면 안되기 때문에 UPS가 있어, 전력이 복구될때까지 전력을 공급함
![alt text](이미지/image-106.png)


![alt text](이미지/image-107.png)
- 만약 데이터 센터 조차도 부족하다면
  - 데이터 센터를 더 많이 만들어야함
  - 어디에? 그리고 얼마나?

![alt text](이미지/image-108.png)

- 데이터 센터는 전 지구적으로 분산되어 있음

- Why?
  - 1. 실제 사용하는 유저에 **물리적**으로 가까워야 함.
  - 2. 각 주 혹은 나라마다 **전기**가 싼 곳에 데이터 센터를 설치함
  - 3. **[가용성 영역]** 데이터 센터가 하나의 지역에만 있으면, 자연재해, 전력 차단 등으로 인해 서비스가 중단될 수 있음 따라서 여러 데이터 센터를 분산하여 서비스를 제공함.


### 트렌드 : 모듈러 데이터 센터
![alt text](이미지/image-109.png)

#### 문제점 1. 규모(dimension)
1. **부하(Load)의 변동성**:
   - `최대 부하(피크 부하)`는 평균 부하보다 2배~10배 더 큼.(블랙프라이데이)
   - 수요(Demand)가 `시간`에 따라 크게 변동.

2. **서버 자원 활용의 비효율성**:
   - 기존 데이터 센터의 서버 활용률은 5%~20% 수준.
   - 부하에 따른 provisioning(자원 할당)이 필요함.
   - 즉, 80%~95%의 자원이 낭비됨.
3. **딜레마**:
   - **최대 부하에 맞춰 자원 할당**: 자원 낭비 발생.
   - **최대 부하보다 적게 자원 할당**: 작업 실패와 고객 이탈
  
즉, 자원 낭비와 고객 이탈 사이에서 최적의 균형을 찾아야 함.

#### 문제점 2. 비용

##### 1. 하드웨어에 대한 높은 투자 비용
- **작은 클러스터**도 쉽게 $100,000 이상의 비용이 발생.
- **예시**: Microsoft는 단일 데이터 센터에 $499M(4억 9900만 달러) 투자.
  - 현재에는 최소한 `조`단위로 투자해야함.

##### 2. 전문 지식 필요
- 대규모 클러스터를 계획하고 설정하는 과정이 매우 복잡함.
- 클러스터는 특수 소프트웨어 등이 필요할 수 있음.

##### 3. 유지보수 필요
- 고장난 하드웨어 교체, 소프트웨어 업그레이드, 사용자 계정 관리 등 `지속적인 관리`가 필요.


#### 문제점 3. 확장성


##### 1. **확장을 늘리기(Scaling Up)가 어려움**
- 새로운 장비를 주문, 설치, 기존 클러스터에 `통합`하는 과정이 필요하며 몇 주가 소요될 수 있음.
- 큰 규모로 확장하려면 대규모 `재설계`가 필요할 수 있음.
  - 예: 새로운 스토리지 시스템, 네트워크 연결, 건물 등.

##### 2. **확장을 줄이기(Scaling Down)가 어려움**
- **잉여 하드웨어**를 어떻게 처리할지 문제가 됨.
- 서버의 유휴 전력은 최대 부하의 약 60% 수준:
  - `작업이 없어도 에너지가 소비됨`. -> gpu를 제외하고 메모리(Dram)이 가장 많은 전력을 소모함(전원이 없어지면 메모리가 사라지므로) -> 따라서 유후 전력이 많이 소모됨.
- 건물과 같은 고정 비용은 변하지 않음.


### 해결책: 발전소 비유 (The Power Plant Analogy)
![alt text](이미지/image-110.png)

#### 과거: 각자가 자신의 전력원을 보유
- 과거에는 모든 기계 혹은 발전기가 자신의 전력원을 가지고 있어야 했음.
  - 예: 수차(Waterwheel), 증기 엔진(Steam Engine).
- 현대의 클러스터 컴퓨팅과 마찬가지로, 막대한 초기 투자비용, 운영 및 유지보수 비용, 확장성 문제가 발생 했음.

![alt text](이미지/image-111.png)
데이터 센터를 짓기 위해 powerplant를 짓고

![alt text](이미지/image-113.png)
발전소에서 전기를 생산하고, 사용한 만큼 고객에게 비용을 청구함


![alt text](이미지/image-114.png)

#### 따라서, 클라우드 컴퓨팅이 등장함.
![alt text](이미지/image-115.png)

##### 주요 특성
- **온디맨드 셀프 서비스**: 사용자가 필요할 때마다 자원을 요청하고 사용할 수 있음.
- **광범위한 네트워크 접근**: 다양한 장치에서 네트워크를 통해 자원에 접근할 수 있음.
- **자원 풀링**: 여러 사용자가 자원을 공유하여 사용함.
- **빠른 확장성**: 필요에 따라 자원을 빠르게 확장하거나 축소할 수 있음.
- **측정된 서비스**: 사용한 자원에 대해 측정하고 비용을 청구함.
  
![alt text](이미지/image-116.png)
- 기존의 데이터 센터는 일정 수준의 capacity를 유지해야 했으나, 클라우드 컴퓨팅은 요구(demand)에 따라 capacity를 조절할 수 있음.

#### 클라우드 컴퓨팅 : Everything as a Service !!! 정확한 정의 !!! 중요.
![alt text](이미지/image-117.png)


![alt text](이미지/image-118.png)

![alt text](이미지/image-119.png)

![alt text](이미지/image-120.png)

![alt text](이미지/image-123.png)
ex> 병원,금융회사, 정부기관 일정 부분은 민감 혹은 보호해야할 정보가 있고, 일부는 보안하지 않아도 될만한 정보가 있음 -> 따라서 public cloud와 private cloud를 혼합하여 사용함

![alt text](이미지/image-124.png)
- 각 회사의 기밀(비즈니스)정보를 보호해야함, 그러나 클라우드 컴퓨팅에서 제공하는 서비스가 필요할 때, 어떻게 보호할 것인가? -> private cloud 즉 ,`기업 자체가` 외부 접속 자체를 차단하고, 내부에서만 사용하는 클라우드를 구축함


![alt text](이미지/image-125.png)

![alt text](이미지/image-126.png)


# 14주차
## Is the cloud good for everyThing?
### 클라우드 컴퓨팅의 장단점

#### 문제점
- **감사 요구사항** 등으로 인해 문제가 발생할 수 있음.
- **예시**:
  - 의료 기록 처리
  - 금융 정보 처리
- 즉, 개인이나 법적으로 민감한 데이터를 처리할 때는 클라우드 컴퓨팅이 적합하지 않을 수 있음.
#### 장점
- **비용 절감**
- **신뢰성**
- **관리 용이성**
- **전략적 우위**

#### 단점
- **다운타임** -> 미국의 경우 천재지변이 많이 발생함
- **보안 문제** -> 과연 aws가 내 고객사의 데이터를 조회하지 않을까?, 잘 보안할 수 있을까?
- **벤더 종속** -> 다른 클라우드 서비스로 마이그레이션할때 비용과 시간이 크게 소모됨


> **"클라우드는 모두를 위한 것이지만, 모든 것을 위한 것은 아니다!"**


## What is virtualization?
![alt text](이미지/image-134.png)


![alt text](이미지/image-133.png)

![alt text](이미지/image-135.png)
**Hypervisor**(virtualization)은 머신(하드웨어)를 가상화 하는것, 컨테이너는 os를 가상화 하는것
Hypervisor는 가상머신의 리소스를 실제 머신의 리소스로 매핑하는 역할을 함
ex) 안드로이드 -> 리눅스OS 위에서 돌아감

## Migration
![alt text](이미지/image-136.png)
만약 머신을 업데이트 혹은 점검 하거나, 머신이 고장난다면?
앨리스는 그저 가상머신의 리소스를 다른 머신으로 매핑시키기만 하면 됨

![alt text](이미지/image-137.png)
만약 가상머신의 리소스 보다 실제 머신의 수가 적다면?
-> timesharing을 사용한다.

![alt text](이미지/image-138.png)
같은 실제 머신을 할당받아 사용하는 고객의 데이터는 분리되어있음 즉, 보안
### 가상화의 장단점

#### 장점
- **데이터 격리**: Emil은 Charlie의 데이터에 접근할 수 없음.

#### 단점
- **부하 증가 시 문제**: 부하가 갑자기 증가하면 성능 저하가 발생할 수 있음.
  - 예시: Emil의 VM이 Charlie의 VM과 CPU를 공유하고 있는데, Charlie가 갑자기 큰 계산 작업을 시작하면 Emil의 성능이 저하될 수 있음.
  - 해결책: VMM(Virtual Machine Manager)이 Emil의 소프트웨어를 다른 CPU로 이동시키거나, 다른 머신으로 마이그레이션할 수 있음.

### 요약
- **장점**: 데이터 격리를 통해 보안 강화.
- **단점**: 부하 증가 시 성능 저하 가능성.
  - 해결책: VMM을 통해 자원을 재분배하거나 마이그레이션하여 성능 저하를 방지.
![alt text](이미지/image-139.png)
성능 저하, 부하등을 예측할 수 없다.

# 10 obstacles and opportunities

- 4. Data transfer bottlenecks
- 미국의 경우 각 주마다, 지역마다 인터넷 네트워크 성능 혹은 환경이 다 달라서 데이터 전송 속도가 다르고, 느릴 수 있음
5.Performance - Unpredictable
- timeshare를 사용하기 때문에, 성능이 불안정하고 예측할 수 없음

6.scalable storage
- 데이터가 늘어나면, 저장소가 늘어나야함
- 또한 적은양 혹은 일시적인 데이터를 저장할 때 부적합함-> 저장하고 있는동안 계속 과금

7. Bugs in large distributed systems
- aws나 azure의 경우 엄청난 양의 머신을 사용하는데 엄청난  양의 버그가 발생한다. -> 문제는 해당 버그를 재현할 수 없다-> 디버깅하기 어렵다.

9. reputation fate sharing
- 만약 우연히 범죄자와 같은 물리적인 머신에 할당된다면, 해당 범죄자를 수사하거나 제제할때 가상머신의 ip주소가 같아서 문제가 발생할 수 있음

10. Software licensing

중간고사 이후 여기까지가 시험범위